# Plan: Sync Home Timeline to Obsidian (UI Button MVP)

## Requirements
- Provide a simple UI trigger in the export modal to sync Home Timeline tweets to Obsidian.
- Sync only Home Timeline captures for now (global button, scoped behavior).
- Store tweets as JSONL, grouped by local date, one file per day.
- Keep implementation minimal for experimentation (no complex settings UI yet).

## Technical Approach
- Data source: Dexie captures for `HomeTimelineModule` via `db.extGetCapturedTweets`.
- Transform: map each Tweet to a compact JSON object (id, created_at, screen_name, name, text, url, media, metrics, context), then serialize to JSONL.
- Group by date using tweet `created_at` (local timezone) and write to `Tweets/YYYY-MM-DD.jsonl` in Obsidian.
- Network: use `GM_xmlhttpRequest` (CSP-safe) to call Obsidian Local REST API on `127.0.0.1/localhost` with token header.
- Write strategy: if no append endpoint, GET existing file content (treat 404 as empty), append JSONL, PUT back.
- Minimal dedupe: optional local record or read existing file to filter by `id` (MVP can skip or use simple localStorage set).

## Change Plan (Key Files)
- `src/components/modals/export-data.tsx`: add a “Sync Home Timeline to Obsidian” button + progress UI.
- `src/utils/obsidian.ts` (new): helper for REST calls (GET/PUT) using `GM_xmlhttpRequest`.
- `src/utils/sync.ts` (new): fetch HomeTimeline tweets, build JSONL, group by date, write files, handle errors.
- Userscript header: add `@connect 127.0.0.1` and `@connect localhost`.

## Implementation Notes
- Remind user to enable `HomeTimelineModule` in settings (disabled by default).
- Ensure JSONL ends with newline to avoid line merging.
- Keep UI minimal: a single button in export modal with loading/progress state and basic error summary.
